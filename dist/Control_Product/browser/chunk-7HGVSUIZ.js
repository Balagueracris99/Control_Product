import{c as g}from"./chunk-5LQPTCW5.js";import{Hb as n,N as s,R as u,V as i,cc as l,ed as o,la as p}from"./chunk-3DDZNKYA.js";var a="user",c=class r{constructor(e,t){this.http=e;this.router=t}userSignal=p(this.getStoredUser());isAuthenticated=n(()=>!!this.userSignal());currentUser=n(()=>this.userSignal());login(e){return this.http.post(`${o.apiUrl}/auth/login`,e).pipe(s(t=>this.setSession(t)))}register(e){return this.http.post(`${o.apiUrl}/auth/register`,e).pipe(s(t=>this.setSession(t)))}logout(){localStorage.removeItem(a),this.userSignal.set(null),this.router.navigate(["/login"])}setSession(e){localStorage.setItem(a,JSON.stringify(e.user)),this.userSignal.set(e.user)}getStoredUser(){let e=localStorage.getItem(a);if(!e)return null;try{return JSON.parse(e)}catch{return null}}static \u0275fac=function(t){return new(t||r)(i(l),i(g))};static \u0275prov=u({token:r,factory:r.\u0275fac,providedIn:"root"})};export{c as a};
